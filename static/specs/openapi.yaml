openapi: 3.0.1
info:
  title: Unofficial SureFlap API
  description: "This is a wrapper API for the official SurePetcare API . You can find out more about the installation and usage of this API by visiting the corresponding GitHub repository at [https://gitlab.com/home-automation-fabieu/sureflap-rest-api](https://gitlab.com/home-automation-fabieu/sureflap-rest-api)"
  contact:
    email: dev@sustineo.de
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.0
servers:
  - url: http://localhost:3001
tags:
  - name: Dashboard
    description: Access to the overview
  - name: Households
    description: Everything about your households and users
  - name: Pets
    description: Everything about your pets
  - name: Devices
    description: Everything about your devices
  - name: Users
    description: Everything about your users
paths:
  /dashboard:
    get:
      tags:
        - Dashboard
      summary: Returns an overview of all devices, households,, pets photos, tags and user
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Dashboard"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /devices:
    get:
      tags:
        - Devices
      summary: Return a list of all registred devices
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  anyOf:
                    - $ref: "#/components/schemas/Hub-Short"
                    - $ref: "#/components/schemas/Flap-Short"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini
  /devices/{deviceID}:
    get:
      tags:
        - Devices
      summary: Return detailed informations about a specific device
      parameters:
        - in: path
          name: deviceID
          schema:
            type: integer
          required: true
          description: Numeric ID of the device
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                oneOf:
                  - $ref: "#/components/schemas/Hub"
                  - $ref: "#/components/schemas/Flap"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households:
    get:
      tags:
        - Households
      summary: Return a list of all households
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Household-Short"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini
  /households/{householdID}:
    get:
      tags:
        - Households
      summary: Return detailed informations about a specific household
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Household"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households/{householdID}/pets:
    get:
      tags:
        - Pets
      summary: Return a list of all pets in a specific household
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Pet-Short"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households/{householdID}/pets/{petID}:
    get:
      tags:
        - Pets
      summary: Return detailed informations about a specific pet
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
        - in: path
          name: petID
          schema:
            type: integer
          required: true
          description: Numeric ID of the pet
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Pet"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households/{householdID}/pets/{petID}/location:
    get:
      tags:
        - Pets
      summary: Return short information about a specific pets location
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
        - in: path
          name: petID
          schema:
            type: integer
          required: true
          description: Numeric ID of the pet
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  location:
                    type: string
                  pet_id:
                    type: number
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
    post:
      tags:
        - Pets
      summary: Set the location of a specific pet
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
        - in: path
          name: petID
          schema:
            type: integer
          required: true
          description: Numeric ID of the pet
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                where:
                  type: number
                  enum: [1, 2]
                  description: 1 = inside, 2 = outside
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  pet_id:
                    type: number
                  since:
                    type: string
                    format: date-time
                  tag_id:
                    type: number
                  user_id:
                    type: number
                  where:
                    type: number
                    enum: [1, 2]
                    description: 1 = inside (default), 2 = outside
        "400":
          description: Action failed
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households/{householdID}/pets/location:
    get:
      tags:
        - Pets
      summary: Return a short list of the location of all pets in a specific household
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Location"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households/{householdID}/users:
    get:
      tags:
        - Users
      summary: Return a list of all users in a specific household
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User-Short"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households/{householdID}/users/{userID}:
    get:
      tags:
        - Users
      summary: Return detailed informations about a specific user
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
        - in: path
          name: userID
          schema:
            type: integer
          required: true
          description: Numeric ID of the user
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User-Detail"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households/{householdID}/users/{userID}/photo:
    get:
      tags:
        - Users
      summary: Return detailed informations about a photo from a specific user
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
        - in: path
          name: userID
          schema:
            type: integer
          required: true
          description: Numeric ID of the user
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User-Photo"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
  /households/{householdID}/timeline:
    get:
      tags:
        - Households
      summary: Return a list of all pet activities in a specific household
      parameters:
        - in: path
          name: householdID
          schema:
            type: integer
          required: true
          description: Numeric ID of the household
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Timeline-Entry"
        "403":
          description: Authorization information is missing or invalid. Check the config.ini!
components:
  schemas:
    Dashboard:
      type: object
      properties:
        devices:
          type: array
          items:
            anyOf:
              - $ref: "#/components/schemas/Hub-Short"
              - $ref: "#/components/schemas/Flap-Short"
        households:
          type: array
          items:
            $ref: "#/components/schemas/Household-Dashboard"
        pets:
          type: array
          items:
            $ref: "#/components/schemas/Pet"
        photos:
          type: array
          items:
            $ref: "#/components/schemas/User-Photo"
        tags:
          type: array
          items:
            $ref: "#/components/schemas/Tag"
        user:
          $ref: "#/components/schemas/User"
    Hub:
      type: object
      properties:
        children:
          type: array
          items:
            $ref: "#/components/schemas/Flap-Short"
        control:
          type: object
          properties:
            led_mode:
              type: number
            pairing_mode:
              type: number
        created_at:
          type: string
        household_id:
          type: number
        mac_adress:
          type: string
        name:
          type: string
        product_id:
          type: number
        serial_number:
          type: string
        status:
          type: object
          properties:
            led_mode:
              type: string
            online:
              type: boolean
            pairing_mode:
              type: number
            version:
              type: object
              properties:
                device:
                  type: object
                  properties:
                    firmware:
                      type: number
                    hardware:
                      type: number
        updated_at:
          type: string
          format: date-time
        version:
          type: string
    Flap:
      type: object
      properties:
        control:
          type: object
          properties:
            curfew:
              type: object
              properties:
                enabled:
                  type: boolean
                lock_time:
                  type: string
                  format: time
            fast_polling:
              type: boolean
        created_at:
          type: string
          format: date-time
        household_id:
          type: number
        id:
          type: number
        index:
          type: number
        mac_adress:
          type: string
        name:
          type: string
        pairing_at:
          type: string
          format: date-time
        parent:
          $ref: "#/components/schemas/Hub-Short"
        parent_device_id:
          type: number
        product_id:
          type: number
        status:
          type: object
          properties:
            battery:
              type: number
            learn_mode:
              type: boolean
            locking:
              type: object
              properties:
                curfew:
                  type: object
                  properties:
                    delay_time:
                      type: number
                    lock_time:
                      type: string
                      format: time
                    locked:
                      type: boolean
                    permissions:
                      type: number
                    unlock_time:
                      type: string
                      format: time
                mode:
                  type: number
            online:
              type: boolean
            signal:
              type: object
              properties:
                device_rssi:
                  type: string
                hub_rssi:
                  type: string
            version:
              type: object
              properties:
                lcd:
                  type: object
                  properties:
                    firmware:
                      type: number
                    hardware:
                      type: number
                rf:
                  type: object
                  properties:
                    firmware:
                      type: number
                    hardware:
                      type: number
        updated_at:
          type: string
          format: date-time
        version:
          type: string
    Household:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        id:
          type: number
        name:
          type: string
        pets:
          type: array
          items:
            $ref: "#/components/schemas/Pet-Short"
        share_code:
          type: string
        timezone_id:
          type: number
        updated_at:
          type: string
          format: date-time
        users:
          type: array
          items:
            $ref: "#/components/schemas/User-Short"
        version:
          type: string
    Pet:
      type: object
      properties:
        comments:
          type: string
        created_at:
          type: string
          format: date-time
        gender:
          type: number
        household_id:
          type: number
        id:
          type: number
        name:
          type: string
        photo:
          type: object
          properties:
            created_at:
              type: string
              format: date-time
            id:
              type: number
            location:
              type: string
            updated_at:
              type: string
              format: date-time
            uploading_user_id:
              type: number
            version:
              type: string
        photo_id:
          type: number
        position:
          type: object
          properties:
            device_id:
              type: number
            since:
              type: string
              format: date-time
            tag_id:
              type: number
            where:
              type: number
        species_id:
          type: number
        tag_id:
          type: number
        updated_at:
          type: string
          format: date-time
        version:
          type: string
    User:
      type: object
      properties:
        country_id:
          type: number
        created_at:
          type: string
          format: date-time
        email_adress:
          type: string
        first_name:
          type: string
        id:
          type: number
        language_id:
          type: number
        last_name:
          type: string
        marketing_opt_in:
          type: boolean
        notifications:
          type: object
          properties:
            animal_movement:
              type: boolean
            curfew:
              type: boolean
            device_status:
              type: boolean
            feeding_activity:
              type: boolean
            household_management:
              type: boolean
            intruder_movements:
              type: boolean
            low_battery:
              type: boolean
            new_device_pet:
              type: boolean
            photos:
              type: boolean
        terms_accepted:
          type: boolean
        time_format:
          type: number
        updated_at:
          type: string
          format: time-data
        version:
          type: string
        weight_units:
          type: number
    Location:
      type: object
      properties:
        duration:
          type: string
        location:
          type: string
        name:
          type: string
        since:
          type: string
          format: date-time
    Timeline-Entry:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        data:
          type: string
        id:
          type: number
        movements:
          type: array
          items:
            type: object
            properties:
              created_at:
                type: string
                format: date-time
              direction:
                type: number
                enum: [1, 2]
              id:
                type: number
              time:
                type: string
                format: time
              type:
                type: number
              updated_at:
                type: string
                format: date-time
              user_id:
                type: number
        pets:
          type: array
          items:
            $ref: "#/components/schemas/Pet-Short"
        tags:
          type: array
          items:
            $ref: "#/components/schemas/Tag"
        type:
          type: number
        updated_at:
          type: string
          format: date-time
        users:
          minItems: 0
          type: array
          items:
            type: object
            properties:
              id:
                type: number
              name:
                type: string
    Tag:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        id:
          type: number
        supported_product_ids:
          type: array
          items:
            type: number
        tag:
          type: string
        updated_at:
          type: string
          format: date-time
        version:
          type: string
    Invite:
      type: object
      properties:
        acceptor_user_id:
          type: number
        code:
          type: string
        created_at:
          type: string
          format: date-time
        creator_user_id:
          type: number
        email_adress:
          type: string
        id:
          type: number
        owner:
          type: boolean
        status:
          type: number
        updated_at:
          type: string
          format: date-time
        user:
          type: object
          properties:
            acceptor:
              $ref: "#/components/schemas/User-Invite"
            creator:
              $ref: "#/components/schemas/User-Invite"
        version:
          type: string
    User-Short:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        id:
          type: number
        owner:
          type: boolean
        updated_at:
          type: string
          format: date-time
        version:
          type: string
        write:
          type: boolean
    User-Detail:
      type: object
      properties:
        id:
          type: number
        name:
          type: string
        photo_id:
          type: number
    User-Photo:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        id:
          type: number
        location:
          type: string
        updated_at:
          type: string
          format: date-time
        uploading_user_id:
          type: number
        version:
          type: string
    User-Invite:
      type: object
      properties:
        id:
          type: number
        name:
          type: string
        photo:
          type: object
          properties:
            created_at:
              type: string
              format: date-time
            id:
              type: number
            lcoation:
              type: string
            updated_at:
              type: string
              format: date-time
            uploading_user_id:
              type: number
            version:
              type: string
        photo_id:
          type: number
    Hub-Short:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        household_id:
          type: number
        id:
          type: number
        name:
          type: string
        product_id:
          type: number
        serial_number:
          type: string
        updated_at:
          type: string
          format: date-time
        version:
          type: string
    Flap-Short:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        household_id:
          type: number
        id:
          type: number
        index:
          type: number
        name:
          type: string
        pairing_at:
          type: string
          format: date-time
        parent_device_id:
          type: number
        product_id:
          type: number
        updated_at:
          type: string
          format: date-time
        version:
          type: string
    Household-Short:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        id:
          type: number
        name:
          type: string
        timezone_id:
          type: number
        updated_at:
          type: string
          format: date-time
        version:
          type: string
    Pet-Short:
      type: object
      properties:
        comments:
          type: string
        created_at:
          type: string
          format: date-time
        gender:
          type: number
        household_id:
          type: number
        id:
          type: number
        name:
          type: string
        photo_id:
          type: number
        species_id:
          type: number
        tag_id:
          type: number
        updated_at:
          type: string
          format: date-time
        version:
          type: string
    Household-Dashboard:
      type: object
      properties:
        created_at:
          type: string
          format: date-time
        id:
          type: number
        invites:
          type: array
          items:
            $ref: "#/components/schemas/Invite"
        name:
          type: string
        share_code:
          type: string
        timezone_id:
          type: number
        updated_at:
          type: string
          format: date-time
        users:
          type: array
          items:
            $ref: "#/components/schemas/User-Short"
        version:
          type: string
